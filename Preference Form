<html>
<head>
  <meta http-equiv="pragma" content="no-cache" />
</head>
<body>

TEST 6
<form action="#" method="post" target="self">
<script runat=server>

  Platform.Load("Core","1");

  var responseObject;
  var responseObjectString;
  var requestURL;

  try
  {
    requestURL = "http://cloud.content.jdrf.org/preferencesajax?contactKey" + Request.GetQueryStringParameter("contactKey");
    responseObjectString = HTTP.Get(requestURL);
    eval("responseObject = " + responseObjectString);

    Platform.Response.Write("Request URL: " + requestURL + "</br></br>");
    Platform.Response.Write("Response Object String: " + responseObjectString + "</br></br>");

    var index;
    for (index = 1; index <= responseObject.publicationListSettings.length; index++) {
        Platform.Response.Write("<input type=\"checkbox\"" + "/>" + responseObject.publicationLists[index].Title + "</br></br>");
    }

  }
  catch(e)
  {
    responseObject.error = e.message;
    Platform.Response.Write("Error: " + e.message + "</br></br>");
  }

</script>
</form>
</body>
</html>
